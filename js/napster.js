var COMPILED=!0,goog=goog||{};goog.global=this;goog.DEBUG=!0;goog.LOCALE="en";goog.TRUSTED_SITE=!0;goog.provide=function(a){if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a];for(var b=a;(b=b.substring(0,b.lastIndexOf(".")))&&!goog.getObjectByName(b);)goog.implicitNamespaces_[b]=!0}goog.exportPath_(a)};
goog.setTestOnly=function(a){if(COMPILED&&!goog.DEBUG)throw a=a||"",Error("Importing test-only code into non-debug environment"+a?": "+a:".");};COMPILED||(goog.isProvided_=function(a){return!goog.implicitNamespaces_[a]&&!!goog.getObjectByName(a)},goog.implicitNamespaces_={});goog.exportPath_=function(a,b,c){a=a.split(".");c=c||goog.global;!(a[0]in c)&&c.execScript&&c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)!a.length&&goog.isDef(b)?c[d]=b:c=c[d]?c[d]:c[d]={}};
goog.getObjectByName=function(a,b){for(var c=a.split("."),d=b||goog.global,e;e=c.shift();)if(goog.isDefAndNotNull(d[e]))d=d[e];else return null;return d};goog.globalize=function(a,b){var c=b||goog.global,d;for(d in a)c[d]=a[d]};
goog.addDependency=function(a,b,c){if(!COMPILED){var d;a=a.replace(/\\/g,"/");for(var e=goog.dependencies_,f=0;d=b[f];f++)e.nameToPath[d]=a,a in e.pathToNames||(e.pathToNames[a]={}),e.pathToNames[a][d]=!0;for(d=0;b=c[d];d++)a in e.requires||(e.requires[a]={}),e.requires[a][b]=!0}};goog.ENABLE_DEBUG_LOADER=!0;
goog.require=function(a){if(!COMPILED&&!goog.isProvided_(a)){if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b){goog.included_[b]=!0;goog.writeScripts_();return}}a="goog.require could not find: "+a;goog.global.console&&goog.global.console.error(a);throw Error(a);}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(a){return a};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};
goog.addSingletonGetter=function(a){a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];
!COMPILED&&goog.ENABLE_DEBUG_LOADER&&(goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("script"),b=a.length-1;0<=b;--b){var c=a[b].src,d=c.lastIndexOf("?"),d=
-1==d?c.length:d;if("base.js"==c.substr(d-7,7)){goog.basePath=c.substr(0,d-7);break}}},goog.importScript_=function(a){var b=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[a]&&b(a)&&(goog.dependencies_.written[a]=!0)},goog.writeScriptTag_=function(a){if(goog.inHtmlDocument_()){var b=goog.global.document;if("complete"==b.readyState){if(/\bdeps.js$/.test(a))return!1;throw Error('Cannot write "'+a+'" after document load');}b.write('<script type="text/javascript" src="'+
a+'">\x3c/script>');return!0}return!1},goog.writeScripts_=function(){function a(e){if(!(e in d.written)){if(!(e in d.visited)&&(d.visited[e]=!0,e in d.requires))for(var g in d.requires[e])if(!goog.isProvided_(g))if(g in d.nameToPath)a(d.nameToPath[g]);else throw Error("Undefined nameToPath for "+g);e in c||(c[e]=!0,b.push(e))}}var b=[],c={},d=goog.dependencies_,e;for(e in goog.included_)d.written[e]||a(e);for(e=0;e<b.length;e++)if(b[e])goog.importScript_(goog.basePath+b[e]);else throw Error("Undefined script input");
},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.isDef=function(a){return void 0!==a};goog.isNull=function(a){return null===a};goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};
goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};
goog.UID_PROPERTY_="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},c;for(c in a)b[c]=goog.cloneObject(a[c]);return b}return a};goog.bindNative_=function(a,b,c){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,c){goog.bind=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bindNative_:goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}};goog.mixin=function(a,b){for(var c in b)a[c]=b[c]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval)if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),"undefined"!=typeof goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_)goog.global.eval(a);else{var b=goog.global.document,c=b.createElement("script");c.type="text/javascript";c.defer=!1;c.appendChild(b.createTextNode(a));b.body.appendChild(c);
b.body.removeChild(c)}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,b){var c=function(a){return goog.cssNameMapping_[a]||a},d=function(a){a=a.split("-");for(var b=[],d=0;d<a.length;d++)b.push(c(a[d]));return b.join("-")},d=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?c:d:function(a){return a};return b?a+"-"+d(b):d(a)};goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};
!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b){var c=b||{},d;for(d in c){var e=(""+c[d]).replace(/\$/g,"$$$$");a=a.replace(RegExp("\\{\\$"+d+"\\}","gi"),e)}return a};goog.getMsgWithFallback=function(a){return a};goog.exportSymbol=function(a,b,c){goog.exportPath_(a,b,c)};goog.exportProperty=function(a,b,c){a[b]=c};
goog.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a};
goog.base=function(a,b,c){var d=arguments.callee.caller;if(d.superClass_)return d.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var e=Array.prototype.slice.call(arguments,2),f=!1,g=a.constructor;g;g=g.superClass_&&g.superClass_.constructor)if(g.prototype[b]===d)f=!0;else if(f)return g.prototype[b].apply(a,e);if(a[b]===d)return a.constructor.prototype[b].apply(a,e);throw Error("goog.base called from a method of one name to a method of a different name");};
goog.scope=function(a){a.call(goog.global)};var exports={};goog.exportSymbol("Napster",Napster);goog.exportSymbol("authentication.cookieAge",authentication.cookieAge);goog.exportSymbol("authentication.token",authentication.token);goog.exportSymbol("authentication.userid",authentication.userid);goog.exportSymbol("authentication.username",authentication.username);goog.exportSymbol("authentication.init",authentication.init);goog.exportSymbol("authentication.getUsername",authentication.getUsername);goog.exportSymbol("authentication.hash",authentication.hash);
goog.exportSymbol("authentication.login",authentication.login);goog.exportSymbol("authentication.logout",authentication.logout);goog.exportSymbol("authentication.createUser",authentication.createUser);goog.exportSymbol("authentication.changePassword",authentication.changePassword);goog.exportSymbol("datastore.data",datastore.data);goog.exportSymbol("datastore.root",datastore.root);goog.exportSymbol("datastore.group",datastore.group);goog.exportSymbol("datastore.lastPlayed",datastore.lastPlayed);
goog.exportSymbol("datastore.track",datastore.track);goog.exportSymbol("datastore.user",datastore.user);goog.exportSymbol("debug.log",debug.log);goog.exportSymbol("debug.logFoo",debug.logFoo);goog.exportSymbol("debug.logVal",debug.logVal);goog.exportSymbol("debug.lucky",debug.lucky);goog.exportSymbol("services.metadata",services.metadata);goog.exportSymbol("services.search",services.search);goog.exportSymbol("services.stream",services.stream);goog.exportSymbol("stream.isPlaying",stream.isPlaying);
goog.exportSymbol("stream.newTime",stream.newTime);goog.exportSymbol("stream.newTimeProcessed",stream.newTimeProcessed);goog.exportSymbol("stream.player",stream.player);goog.exportSymbol("stream.syncTimeouts",stream.syncTimeouts);goog.exportSymbol("stream.init",stream.init);goog.exportSymbol("stream.isFinished",stream.isFinished);goog.exportSymbol("stream.length",stream.length);goog.exportSymbol("stream.loadTrack",stream.loadTrack);goog.exportSymbol("stream.mute",stream.mute);
goog.exportSymbol("stream.onFinished",stream.onFinished);goog.exportSymbol("stream.play",stream.play);goog.exportSymbol("stream.processTime",stream.processTime);goog.exportSymbol("stream.sync",stream.sync);goog.exportSymbol("stream.time",stream.time);goog.exportSymbol("stream.updateNowPlaying",stream.updateNowPlaying);goog.exportSymbol("stream.volume",stream.volume);goog.exportSymbol("ui.pageLoadingClass",ui.pageLoadingClass);goog.exportSymbol("ui.playButtonClass",ui.playButtonClass);
goog.exportSymbol("ui.slider",ui.slider);goog.exportSymbol("ui.init",ui.init);goog.exportSymbol("ui.update",ui.update);var stream=new function(){var a=this;a.init=function(){var b=function(){var b=new goog.async.ConditionalDelay(function(){return window.datastoreIsReady});b.onSuccess=function(){a.onFinished()};b.start()},c=function(a){(a=a.data==YT.PlayerState.PLAYING?window.onYouTubeVideoStarted:a.data==YT.PlayerState.ENDED?window.onYouTubeVideoFinished:null)&&a();ui.update()},d=function(){};window.onYouTubeIframeAPIReady=function(){a.player=new YT.Player($("#stream")[0],{height:"390",width:"640",html5:"1",events:{onReady:b,
onStateChange:c,onError:d}})};datastore.user().nowPlayingChild.isPlaying.setOnDisconnect(!1);datastore.user().nowPlayingChild.lastChange.setOnDisconnect(0);a.syncTimeouts=[]};a.isFinished=function(){return a.time()>=a.length()};a.length=function(){return a.player.getDuration()};a.loadTrack=function(b,c,d){a.player.stopVideo();a.time(0,!0);window.onYouTubeVideoStarted=function(){window.onYouTubeVideoStarted=null;window.setTimeout(function(){stream.volume(0);a.time(0,!0);a.play(!0,!0);datastore.track(a.currentTrack).length.set(a.length());
c&&c()},2E3)};datastore.track(b).once("value",function(c){var f=c.val();c=c.name();ui.slider.setMaximum(f.length);datastore.track(b).lastPlayed.set(Date.now());datastore.track(b).lastPlayedBy.set(authentication.userid);datastore.lastPlayed().push(c);a.player.loadVideoById(f.youtubeid);a.currentTrack=b;!0!=d&&(datastore.track(b).playCount.set(++f.playCount),a.updateNowPlaying());c=datastore.data.user.current.library.processed;for(var g in c)f=c[g],f.nowPlayingClass=f.id==a.currentTrack?"now-playing":
""})};a.mute=function(b){!1!=b?a.player.mute():a.player.unMute()};a.onFinished=function(b){window.onYouTubeVideoFinished=function(){a.play(!1);window.clearInterval(ui.slider.playInterval);b&&b()}};a.play=function(b,c){a.isPlaying=!1==b?!1:!0;a.isPlaying?a.volume(100):a.volume(0);window.clearInterval(ui.slider.playInterval);a.isPlaying&&(ui.slider.playInterval=window.setInterval(function(){!ui.slider.valueJustChanged&&a.isPlaying&&a.time()},500));a.isPlaying?a.player.playVideo():a.player.pauseVideo();
ui.update();a.time();!0!=c&&a.updateNowPlaying()};a.processTime=function(a){a=a||0;return(60>a?"0:":"")+(10>a?"0":"")+([].add((new Date(0,0,0,0,0,a)).toLocaleTimeString().match(/[^0:].*/))[0]||0)};a.sync=function(b){b=b||authentication.userid;var c=datastore.user(b);datastore.user(datastore.data.user.current.following).nowPlayingChild.lastChange.off();datastore.user().following.set(b);c.nowPlayingChild.lastChange.on("value",function(b){b=b.val();var e=(Date.now()-b)/1E3;c.nowPlaying.once("value",
function(b){var c=b.val(),d=c.time+(c.isPlaying?e:0);c.track!=a.currentTrack?a.loadTrack(c.track,function(){a.syncTimeouts[0]=window.setTimeout(function(){c.track==a.currentTrack&&a.player.pauseVideo();a.syncTimeouts[1]=window.setTimeout(function(){c.track==a.currentTrack&&(a.play(c.isPlaying,!0),a.time(d,!0))},3E3)},3E3)},!0):(c.isPlaying?a.player.playVideo():a.player.pauseVideo(),a.time(d,!0));ui.update()})})};a.time=function(b,c){if((b=0===b?1:b)&&5>Math.abs(b-a.time()))return b;b&&(a.newTime=
b,!0!=c?a.updateNowPlaying():a.player.seekTo(b,!0));if((b>=a.length()||a.player.getCurrentTime()>=a.length())&&a.isPlaying)a.isPlaying=!1,a.newTime=0,ui.update();a.newTime=a.player.getCurrentTime()||a.newTime;a.newTimeProcessed=a.processTime(a.newTime);a.newTime&&datastore.user().nowPlayingChild.time.set(a.newTime);ui.slider.animatedSetValue(a.newTime);ui.update();return a.newTime};a.updateNowPlaying=function(){datastore.user().nowPlaying.set({isPlaying:a.isPlaying,lastChange:Date.now(),time:a.newTime,
track:a.currentTrack});ui.update()};a.volume=function(b){window.isNaN(b)||a.player.setVolume(b);return a.player.getVolume()}};var init={};authentication.init();ui.init();stream.init();var controllers={},Napster=function(a){a.authentication=authentication;a.datastore=datastore;a.services=services;a.stream=stream;a.ui=ui;if(authentication.token){a.safeApply=function(b){var c=a.$root.$$phase;"$apply"==c||"$digest"==c?b&&"function"===typeof b&&b():a.$apply(b)};var b=ui.update;ui.update=function(c){b();a.safeApply(c)};var c={},d=function(a,b,d){var e=function(c){a[b]=c.val();ui.update()};c[d]=c[d]||e;return c[d]},e={},f=function(a,b){var c=function(b){a[b.name()]=b.val();ui.update()};
e[b]=e[b]||c;return e[b]};datastore.lastPlayed().limit(500).on("child_added",function(a){f(datastore.data.lastPlayed)(a);goog.object.getKeys(datastore.data.lastPlayed).exclude("processed").forEach(function(a){var b=datastore.data.lastPlayed[a],c="track"+b;datastore.track(b).off("value",d(datastore.data.track,b,c));datastore.track(b).on("value",function(a){d(datastore.data.track,b,c)(a);datastore.data.lastPlayed.processed[b]=a.val()})})});datastore.user().on("value",function(a){d(datastore.data.user,
authentication.userid)(a);var b=datastore.data.user[authentication.userid];if(!1==b.isOnline)datastore.user().isOnline.set(!0);else{for(var c in b.groups){a=b.groups[c];var e="group"+a,j=e+"members",k=e+"messages",e=e+"name",m=datastore.group(a).members().limit(500),n=datastore.group(a).messages().limit(500),p=datastore.group(a).name;datastore.data.group[c]=datastore.data.group[c]||{members:{},messages:{},name:""};m.off("child_added",f(datastore.data.group[a].members,j));m.on("child_added",f(datastore.data.group[a].members,
j));n.off("child_added",f(datastore.data.group[a].messages,k));n.on("child_added",f(datastore.data.group[a].messages,k));p.off("value",d(datastore.data.group[a],"name",e));p.on("value",d(datastore.data.group[a],"name",e))}b.library=b.library||{};b.library.processed=b.library.processed||{};goog.object.getKeys(b.library).exclude("processed").map(function(a){return b.library[a]}).add(b.nowPlaying.track).unique().compact().forEach(function(a){var c="track"+a;datastore.track(a).off("value",d(datastore.data.track,
a,c));datastore.track(a).on("value",function(e){d(datastore.data.track,a,c)(e);var f=e.val();f.id=a;f.length=stream.processTime(f.length);f.lastPlayed=(new Date(f.lastPlayed)).format("{12hr}{tt}, {yyyy}-{MM}-{dd}");authentication.getUsername(f.lastPlayedBy,function(c){f.lastPlayedBy=c;f.nowPlayingClass="";if(f.id==(stream.currentTrack||b.nowPlaying.track))f.nowPlayingClass="now-playing",b.nowPlayingProcessed=f;b.library.processed[a]=f;ui.update();stream.player.stopVideo&&!window.libraryIsLoaded&&
(window.libraryIsLoaded=!0,stream.sync())})})});datastore.data.user.current=b;window.datastoreIsReady=!0;ui.update()}})}};var services=new function(){var a=this;a.metadata=function(a,c,d){a={callback:"callback",type:"master",q:a};c&&goog.object.add(a,"artist",c);(new goog.net.Jsonp("http://api.discogs.com/database/search")).send(a,function(a){var b=[],c=[];(goog.object.getValueByKeys(a,"data","results")||[]).slice(0,20).forEach(function(a){var d=(a.title||"").split("-"),e=d.slice(1).join("").trim(),d=d[0].split("(")[0].trim(),j=(a.genre||[])[0];a=a.year;var k=authentication.hash(e+d+a);b.add({title:e,artist:d,genre:j,
year:a,id:k});c.add(new goog.async.Deferred)});d(b,c)})};a.search=function(b,c,d){a.metadata(b,c,function(b,c){for(var g=goog.async.DeferredList.gatherResults(c),h=0;h<b.length;++h){var l=b[h];a.stream(l.title,l.artist,h,function(a,b){c[b].callback(a,b)})}g.addCallback(function(a){a.forEach(function(a,c){var d=b[c];d.youtubeid=a.youtubeid;d.youtubeviews=a.youtubeviews;d.length=a.length});a=function(a){return a.youtubeid};a=b.findAll(a).unique(a).sortBy(function(a){return a.youtubeviews},!0);a.forEach(function(a){var b=
datastore.track(a.id);b.update({artist:a.artist,genre:a.genre,length:(a.length||0).toNumber(),title:a.title,year:(a.year||42).toNumber(),youtubeid:a.youtubeid,youtubeviews:(a.youtubeviews||0).toNumber()});b.update({playCount:0})});d(a)})})};a.stream=function(a,c,d,e){c=c.replace("Various","Song");(new goog.net.Jsonp("http://gdata.youtube.com/feeds/api/videos")).send({callback:"callback",alt:"json-in-script",v:2,q:"{0} {1} {2}".assign({"0":a,1:c,2:[].reduce(function(d,e){var h=e.toLowerCase();return d+
(!a.toLowerCase().has(h)&&!c.toLowerCase().has(h)?' -"{0}"'.assign({"0":h}):"")},"")})},function(a){if(!goog.object.getValueByKeys(a,"feed","entry"))return e({},d);a=a.feed.entry.map(function(a){var b=(goog.object.getValueByKeys(a,"id","$t")||"").split("video:")[1],c=(goog.object.getValueByKeys(a,"yt$statistics","viewCount")||0).toNumber(),d=goog.object.getValueByKeys(a,"media$group","media$content",0,"duration"),e=((a.yt$accessControl||{}).find(function(a){return"embed"==a.action})||{}).permission;
a=goog.object.getValueByKeys(a,"app$control","yt$state");return{youtubeid:b,youtubeviews:c,length:d,isEmbeddable:!("allowed"!=e||a)}}).findAll(function(a){return a.isEmbeddable}).slice(0,5).sortBy(function(a){return a.youtubeviews},!0);e(a[0]||{},d)})}};var authentication=new function(){var a=this,b=function(a){return"{0}@firebase.com".assign({"0":a})};a.init=function(){a.cookieAge=5E6;a.token=goog.net.cookies.get("napsterfm-token");a.userid=goog.net.cookies.get("napsterfm-userid");a.username=goog.net.cookies.get("napsterfm-username");a.token&&(datastore.root.auth(a.token),datastore.user().isOnline.set(!0),datastore.user().isOnline.setOnDisconnect(!1))};a.getUsername=function(a,b){datastore.user(a).username.once("value",function(a){b(a.val().replace("@firebase.com",
""))})};a.hash=function(a){return(new goog.crypt.Hmac(new goog.crypt.Sha256,"napster")).getHmac(a).map(function(a){return a.toString(36)}).join("")};a.login=function(c,d){var e=new goog.async.Deferred;(new FirebaseAuthClient(datastore.root)).login("password",b(c),d,function(b,d,h){b?e.callback(b):(goog.net.cookies.set("napsterfm-token",d,a.cookieAge),goog.net.cookies.set("napsterfm-userid",h.id,a.cookieAge),goog.net.cookies.set("napsterfm-username",c,a.cookieAge),document.location.reload(!0))});return e};
a.logout=function(){datastore.root.unauth();goog.net.cookies.remove("napsterfm-token");goog.net.cookies.remove("napsterfm-userid");goog.net.cookies.remove("napsterfm-username");document.location.reload(!0)};a.createUser=function(a,d){var e=new goog.async.Deferred;(new FirebaseAuthClient(datastore.root)).createUser(b(a),d,function(a){a&&e.callback(a)});return e};a.changePassword=function(a,d,e){var f=new goog.async.Deferred;(new FirebaseAuthClient(datastore.root)).changePassword(b(a),d,e,function(a){a&&
f.callback(a)});return f}};var ui=new function(){var a=this;a.init=function(){window.onhashchange=function(){var a=function(a,b,c){a=$(a);for(var g=0;g<a.length;++g){var h=a[g];goog.dom.classes.enable(c?c(h):h,"active",h.getAttribute(b)==window.location.hash)}};a(".navbar a","href",function(a){return a.parentNode});a("[hash-location]","hash-location")};if(window.location.hash)window.onhashchange();else window.location.hash=$(".navbar li.active")[0].getChildren()[0].getAttribute("href");var b=new goog.ui.TableSorter;b.setDefaultSortFunction(goog.ui.TableSorter.alphaSort);
b.decorate($("#library-table")[0]);a.slider=new goog.ui.Slider;a.slider.setHandleMouseWheel(!0);a.slider.setMoveToPointEnabled(!0);a.slider.onclick=function(){a.slider.valueJustChanged=!0;stream.time(a.slider.getValue());window.setTimeout(function(){a.slider.valueJustChanged=!1},1E3)};a.slider.decorate($("#player .slider")[0])};a.update=function(){a.pageLoadingClass=window.isNaN(stream.newTime)?"loading":"";a.playButtonClass=stream.isPlaying?"playing":"paused"}};var debug=new function(){this.log=function(a){console.log(a)};this.logFoo=function(){console.log("foo")};this.logVal=function(a){console.log(a.val())};this.lucky=function(a){datastore.user().library.push(a[0].id)}};var datastore=new function(){var a=this;a.data={group:{},lastPlayed:{processed:{}},track:{},user:{}};a.root=new Firebase("https://napsterfm.firebaseio.com/");a.group=function(b){b=(b||0).toString();var c=a.root.child("group").child(b);c.members=c.child("members");c.member=function(a){a=a.toString();return c.members.child(a)};c.messages=c.child("messages");c.message=function(a){a=a.toString();a=c.messages.child(a);a.author=a.child("author");a.created=a.child("created");a.text=a.child("text");return a};
c.name=c.child("name");return c};a.lastPlayed=function(){return a.root.child("lastPlayed")};a.track=function(b){b=b.toString();b=a.root.child("track").child(b);b.artist=b.child("artist");b.genre=b.child("genre");b.lastPlayed=b.child("lastPlayed");b.lastPlayedBy=b.child("lastPlayedBy");b.length=b.child("length");b.playCount=b.child("playCount");b.title=b.child("title");b.year=b.child("year");b.youtubeid=b.child("youtubeid");b.youtubeviews=b.child("youtubeviews");return b};a.user=function(b){b=(b||
authentication.userid).toString();var c=a.root.child("user").child(b);c.groups=c.child("groups");c.group=function(a){a=a.toString();return c.groups.child(a)};c.following=c.child("following");c.hotlist=c.child("hotlist");c.hotlistMember=function(a){a=a.toString();return c.hotlist.child(a)};c.isOnline=c.child("isOnline");c.nowPlaying=c.child("nowPlaying");c.nowPlayingChild={isPlaying:c.nowPlaying.child("isPlaying"),lastChange:c.nowPlaying.child("lastChange"),time:c.nowPlaying.child("time"),track:c.nowPlaying.child("track")};
c.library=c.child("library");c.libraryTrack=function(a){a=a.toString();return c.library.child(a)};c.transfers=c.child("transfers");c.transfer=function(a){a=a.toString();a=c.transfers.child(a);a.from=a.child("from");a.track=a.child("track");return a};c.username=c.child("username");return c}};var closurequery={},$=function(a){var b=goog.dom.query(a),c=1>b.length;c&&1>(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("parsererror").length?(c=goog.dom.createElement("div"),c.innerHTML=a,b[0]=c.firstChild):c&&(b[0]={});$_domHelpers.forEach(function(a){for(var c=0;c<b.length;++c)b[c][a]=b[c][a]||goog.dom[a].fill(b[c]);b[a]=b[0]&&b[0][a]});return b},$_domHelpers=goog.object.getKeys(goog.dom).filter(function(a){return!a.has("_")&&"function"===typeof goog.dom[a]});
$_domHelpers.forEach(function(a){$[a]=goog.dom[a]});
