var d=!0,f=!1,g=g||{},j=this;function k(a,b){var c=a.split("."),e=j;!(c[0]in e)&&e.execScript&&e.execScript("var "+c[0]);for(var h;c.length&&(h=c.shift());)!c.length&&void 0!==b?e[h]=b:e=e[h]?e[h]:e[h]={}};k("authentication.cookieAge",l.fa);k("authentication.token",l.H);k("authentication.userid",l.w);k("authentication.username",l.I);k("authentication.init",l.p);k("authentication.getUsername",l.la);k("authentication.hash",l.hash);k("authentication.login",l.Q);k("authentication.logout",l.ua);k("authentication.createUser",l.L);k("authentication.changePassword",l.K);k("datastore.data",m.data);k("datastore.root",m.root);k("datastore.group",m.group);k("datastore.lastPlayed",m.q);k("datastore.track",m.d);
k("datastore.user",m.e);k("debug.log",q.log);k("debug.logFoo",q.sa);k("debug.logVal",q.ta);k("debug.lucky",q.va);k("services.metadata",s.R);k("services.search",s.search);k("services.stream",s.$);k("stream.isPlaying",t.c);k("stream.newTime",t.g);k("stream.newTimeProcessed",t.ya);k("stream.player",t.b);k("stream.syncTimeouts",t.F);k("stream.init",t.p);k("stream.isFinished",t.pa);k("stream.length",t.length);k("stream.loadTrack",t.P);k("stream.mute",t.S);k("stream.onFinished",t.T);k("stream.play",t.play);
k("stream.processTime",t.Y);k("stream.sync",t.Ga);k("stream.time",t.time);k("stream.updateNowPlaying",t.v);k("stream.volume",t.volume);k("ui.pageLoadingClass",u.Aa);k("ui.playButtonClass",u.Ba);k("ui.slider",u.f);k("ui.init",u.p);k("ui.update",u.update);var t=new function(){var a=this;a.p=function(){function b(){}function c(a){(a=a.data==YT.da.Ma?window.U:a.data==YT.da.Ka?window.za:null)&&a();u.update()}function e(){var b=new g.async.Ia(function(){return window.Xa});b.rb=function(){a.T()};b.start()}window.sb=function(){a.b=new YT.Na(w("#stream")[0],{height:"390",width:"640",kb:"1",Za:{onReady:e,onStateChange:c,onError:b}})};m.e().r.c.Z(f);m.e().r.u.Z(0);a.F=[]};a.pa=function(){return a.time()>=a.length()};a.length=function(){return a.b.eb()};a.P=
function(b,c,e){a.b.Bb();a.time(0,d);window.U=function(){window.U=null;window.setTimeout(function(){t.volume(0);a.time(0,d);a.play(d,d);m.d(a.k).length.set(a.length());c&&c()},2E3)};m.d(b).V("value",function(c){var p=c.z();c=c.name();u.f.yb(p.length);m.d(b).q.set(Date.now());m.d(b).ra.set(l.w);m.q().push(c);a.b.mb(p.i);a.k=b;e!=d&&(m.d(b).D.set(++p.D),a.v());c=m.data.e.ha.C.Da;for(var r in c)p=c[r],p.ob=p.id==a.k?"now-playing":""})};a.S=function(b){b!=f?a.b.S():a.b.Db()};a.T=function(b){window.za=
function(){a.play(f);window.clearInterval(u.f.X);b&&b()}};a.play=function(b,c){a.c=b==f?f:d;a.c?a.volume(100):a.volume(0);window.clearInterval(u.f.X);a.c&&(u.f.X=window.setInterval(function(){!u.f.ba&&a.c&&a.time()},500));a.c?a.b.Ca():a.b.W();u.update();a.time();c!=d&&a.v()};a.Y=function(a){a=a||0;return(60>a?"0:":"")+(10>a?"0":"")+([].add((new Date(0,0,0,0,0,a)).toLocaleTimeString().match(/[^0:].*/))[0]||0)};a.Ga=function(b){b=b||l.w;var c=m.e(b);m.e(m.data.e.ha.M).r.u.pb();m.e().M.set(b);c.r.u.qb("value",
function(b){b=b.z();var h=(Date.now()-b)/1E3;c.m.V("value",function(b){var c=b.z(),e=c.time+(c.c?h:0);c.d!=a.k?a.P(c.d,function(){a.F[0]=window.setTimeout(function(){c.d==a.k&&a.b.W();a.F[1]=window.setTimeout(function(){c.d==a.k&&(a.play(c.c,d),a.time(e,d))},3E3)},3E3)},d):(c.c?a.b.Ca():a.b.W(),a.time(e,d));u.update()})})};a.time=function(b,c){if((b=0===b?1:b)&&5>Math.abs(b-a.time()))return b;b&&(a.g=b,c!=d?a.v():a.b.vb(b,d));if((b>=a.length()||a.b.ka()>=a.length())&&a.c)a.c=f,a.g=0,u.update();a.g=
a.b.ka()||a.g;a.ya=a.Y(a.g);a.g&&m.e().r.time.set(a.g);u.f.Sa(a.g);u.update();return a.g};a.v=function(){m.e().m.set({c:a.c,u:Date.now(),time:a.g,d:a.k});u.update()};a.volume=function(b){window.qa(b)||a.b.Ab(b);return a.b.ib()}};var s=new function(){var a=this;a.R=function(a,c,e){a={J:"callback",type:"master",Ea:a};c&&g.object.add(a,"artist",c);(new g.h.ca("http://api.discogs.com/database/search")).send(a,function(a){var b=[],c=[];(g.object.o(a,"data","results")||[]).slice(0,20).forEach(function(a){var e=(a.title||"").split("-"),h=e.slice(1).join("").trim(),e=e[0].split("(")[0].trim(),y=(a.t||[])[0];a=a.A;var z=l.hash(h+e+a);b.add({title:h,s:e,t:y,A:a,id:z});c.add(new g.async.B)});e(b,c)})};a.search=function(b,c,e){a.R(b,
c,function(b,c){for(var r=g.async.Ja.bb(c),n=0;n<b.length;++n){var v=b[n];a.$(v.title,v.s,n,function(a,b){c[b].J(a,b)})}r.Qa(function(a){function c(a){return a.i}a.forEach(function(a,c){var e=b[c];e.i=a.i;e.j=a.j;e.length=a.length});a=b.ja(c).unique(c).Fa(function(a){return a.j},d);a.forEach(function(a){var b=m.d(a.id);b.update({s:a.s,t:a.t,length:(a.length||0).G(),title:a.title,A:(a.A||42).G(),i:a.i,j:(a.j||0).G()});b.update({D:0})});e(a)})})};a.$=function(a,c,e,h){c=c.replace("Various","Song");
(new g.h.ca("http://gdata.youtube.com/feeds/api/videos")).send({J:"callback",alt:"json-in-script",Fb:2,Ea:"{0} {1} {2}".assign({"0":a,1:c,2:[].reduce(function(e,h){var n=h.toLowerCase();return e+(!a.toLowerCase().N(n)&&!c.toLowerCase().N(n)?' -"{0}"'.assign({"0":n}):"")},"")})},function(a){if(!g.object.o(a,"feed","entry"))return h({},e);a=a.$a.Ya.map(function(a){var b=(g.object.o(a,"id","$t")||"").split("video:")[1],c=(g.object.o(a,"yt$statistics","viewCount")||0).G(),e=g.object.o(a,"media$group",
"media$content",0,"duration"),h=((a.Gb||{}).find(function(a){return"embed"==a.action})||{}).tb;a=g.object.o(a,"app$control","yt$state");return{i:b,j:c,length:e,oa:!("allowed"!=h||a)}}).ja(function(a){return a.oa}).slice(0,5).Fa(function(a){return a.j},d);h(a[0]||{},e)})}};var l=new function(){function a(a){return"{0}@firebase.com".assign({"0":a})}var b=this;b.p=function(){b.fa=5E6;b.H=g.h.n.get("napsterfm-token");b.w=g.h.n.get("napsterfm-userid");b.I=g.h.n.get("napsterfm-username");b.H&&(m.root.Ta(b.H),m.e().O.set(d),m.e().O.Z(f))};b.la=function(a,b){m.e(a).I.V("value",function(a){b(a.z().replace("@firebase.com",""))})};b.hash=function(a){return(new g.ga.La(new g.ga.Oa,"napster")).fb(a).map(function(a){return a.toString(36)}).join("")};b.Q=function(b){var e=new g.async.B;
(new FirebaseAuthClient(m.root)).Q("password",a(b));return e};b.ua=function(){m.root.Eb();g.h.n.remove("napsterfm-token");g.h.n.remove("napsterfm-userid");g.h.n.remove("napsterfm-username");document.location.reload(d)};b.L=function(b,e){var h=new g.async.B;(new FirebaseAuthClient(m.root)).L(a(b),e);return h};b.K=function(b,e,h){var p=new g.async.B;(new FirebaseAuthClient(m.root)).K(a(b),e,h);return p}};var u=new function(){var a=this;a.p=function(){window.onhashchange=function(){function a(b,c,p){b=w(b);for(var r=0;r<b.length;++r){var n=b[r];g.l.Va.enable(p?p(n):n,"active",n.getAttribute(c)==window.location.hash)}}a(".navbar a","href",function(a){return a.parentNode});a("[hash-location]","hash-location")};if(window.location.hash)window.onhashchange();else window.location.hash=w(".navbar li.active")[0].cb()[0].getAttribute("href");var b=new g.aa.ea;b.wb(g.aa.ea.Ra);b.ia(w("#library-table")[0]);a.f=
new g.aa.Pa;a.f.xb(d);a.f.zb(d);a.f.onclick=function(){a.f.ba=d;t.time(a.f.hb());window.setTimeout(function(){a.f.ba=f},1E3)};a.f.ia(w("#player .slider")[0])};a.update=function(){a.Aa=window.qa(t.g)?"loading":"";a.Ba=t.c?"playing":"paused"}};var q=new function(){this.log=function(a){console.log(a)};this.sa=function(){console.log("foo")};this.ta=function(a){console.log(a.z())};this.va=function(a){m.e().C.push(a[0].id)}};var m=new function(){var a=this;a.data={group:{},q:{Da:{}},d:{},e:{}};a.root=new Firebase("https://napsterfm.firebaseio.com/");a.group=function(b){b=(b||0).toString();var c=a.root.a("group").a(b);c.wa=c.a("members");c.nb=function(a){a=a.toString();return c.wa.a(a)};c.xa=c.a("messages");c.message=function(a){a=a.toString();a=c.xa.a(a);a.Ua=a.a("author");a.Wa=a.a("created");a.text=a.a("text");return a};c.name=c.a("name");return c};a.q=function(){return a.root.a("lastPlayed")};a.d=function(b){b=b.toString();
b=a.root.a("track").a(b);b.s=b.a("artist");b.t=b.a("genre");b.q=b.a("lastPlayed");b.ra=b.a("lastPlayedBy");b.length=b.a("length");b.D=b.a("playCount");b.title=b.a("title");b.A=b.a("year");b.i=b.a("youtubeid");b.j=b.a("youtubeviews");return b};a.e=function(b){b=(b||l.w).toString();var c=a.root.a("user").a(b);c.ma=c.a("groups");c.group=function(a){a=a.toString();return c.ma.a(a)};c.M=c.a("following");c.na=c.a("hotlist");c.jb=function(a){a=a.toString();return c.na.a(a)};c.O=c.a("isOnline");c.m=c.a("nowPlaying");
c.r={c:c.m.a("isPlaying"),u:c.m.a("lastChange"),time:c.m.a("time"),d:c.m.a("track")};c.C=c.a("library");c.lb=function(a){a=a.toString();return c.C.a(a)};c.Ha=c.a("transfers");c.Cb=function(a){a=a.toString();a=c.Ha.a(a);a.ab=a.a("from");a.d=a.a("track");return a};c.I=c.a("username");return c}};function w(a){var b=g.l.ub(a),c=1>b.length;c&&1>(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("parsererror").length?(c=g.l.createElement("div"),c.innerHTML=a,b[0]=c.firstChild):c&&(b[0]={});x.forEach(function(a){for(var c=0;c<b.length;++c)b[c][a]=b[c][a]||g.l[a].fill(b[c]);b[a]=b[0]&&b[0][a]});return b}var x=g.object.gb(g.l).filter(function(a){return!a.N("_")&&"function"===typeof g.l[a]});x.forEach(function(a){w[a]=g.l[a]});
