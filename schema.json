{
	"rules": {
		".read": true,
		".write": false,
		"group": {
			"$group": {
				".write": "!data.exists()",
				"members": {
					"$member": {
						".write": "!data.exists() || data.val() == auth.id",
						".validate": "newData.isString() && root.child('user/' + newData.val()).exists()"
					}
				},
				"messages": {
					"$message": {
						".write": "!data.exists()",
						"author": {
							".validate": "newData.isString() && newData.val() == auth.id && root.child('user/' + newData.val()).exists()"
						},
						"created": {
							".validate": "newData.isNumber() && newData.val() < now"
						},
						"text": {
							".validate": "newData.isString()"
						}
					}
				},
				"name": {
					".validate": "newData.isString()"
				}
			}
		},
		"lastPlayed": {
			"$track": {
				".write": "!data.exists()",
				".validate": "newData.isString() && root.child('track/' + newData.val()).exists()"
			}
		},
		"track": {
			"$track": {
				".write": "!data.exists()",
				"$trackAttribute": {
					".write": "!data.exists()"
				},
				"artist": {
					".validate": "newData.isString()"
				},
				"genre": {
					".validate": "newData.isString()"
				},
				"lastPlayed": {
					".write": true,
					".validate": "newData.isNumber() && (!data.exists() || data.val() < newData.val()) && newData.val() < now"
				},
				"lastPlayedBy": {
					".write": true,
					".validate": "newData.isString() && newData.val() == auth.id && root.child('user/' + newData.val()).exists()"
				},
				"length": {
					".validate": "newData.isNumber()"
				},
				"playCount": {
					".write": true,
					".validate": "newData.isNumber() && (!data.exists() || data.val() + 1 == newData.val())"
				},
				"title": {
					".validate": "newData.isString()"
				},
				"year": {
					".validate": "newData.isNumber()"
				},
				"youtubeid": {
					".validate": "newData.isString()"
				},
				"youtubeviews": {
					".validate": "newData.isNumber()"
				}
			}
		},
		"user": {
			"$user": {
				".write": "$user == auth.id",
				"groups": {
					"$group": {
						".write": "!data.exists()",
						".validate": "newData.isString() && root.child('group/' + newData.val()).exists()"
					}
				},
				"hotlist": {
					"$user": {
						".validate": "newData.isString() && root.child('user/' + newData.val()).exists()"
					}
				},
				"isOnline": {
					".validate": "newData.isBoolean()"
				},
				"library": {
					"$track": {
						".validate": "newData.isString() && root.child('track/' + newData.val()).exists()"
					}
				},
				"transfers": {
					"$transfer": {
						".write": "!data.exists()",
						"from": {
							".validate": "newData.isString() && newData.val() == auth.id && root.child('user/' + newData.val()).exists()"
						},
						"track": {
							".validate": "newData.isString() && root.child('track/' + newData.val()).exists()"
						}
					}
				}
			}
		}
	}
}
